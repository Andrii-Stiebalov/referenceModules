{"ast":null,"code":"import { Howl } from \"howler\";\nimport nearIcon from \"../../../Components/nearIcon.vue\";\nimport openIcon from \"../../../Components/openIcon.vue\";\nimport checkMark from \"../../../Components/checkMark.vue\";\nexport default {\n  data() {\n    return {\n      selectedTypeBattle: 1,\n      selectedSoundId: 1,\n      selectedPlayerId: -1,\n      availableSongsId: [7, 8],\n      sound: null,\n      playedId: -1\n    };\n  },\n  watch: {\n    selectedTypeBattle() {\n      this.selectedPlayerId = -1;\n    }\n  },\n  computed: {\n    soundList() {\n      return this.$store.getters[\"danceMingame/getTrackList\"];\n    },\n    filterSoundList() {\n      return this.soundList.filter(sound => this.selectDanceData.availableSongsId.includes(sound.id));\n    },\n    isReadyToStart() {\n      if (!this.selectedSoundId) return false;\n      return this.selectedTypeBattle == 2 || this.selectedPlayerId !== -1;\n    }\n  },\n  props: {\n    playersNear: Array,\n    selectDanceData: Object\n  },\n  methods: {\n    getSoundItemById(id) {\n      return this.soundList.find(sound => sound.id == id)?.name;\n    },\n    playSound(link) {\n      if (this.sound && this.sound.link === link) {\n        this.sound.stop();\n        clearTimeout(this.stopSoundTimeout);\n        this.sound = null;\n        return;\n      }\n      if (this.sound) {\n        this.sound.stop();\n        clearTimeout(this.stopSoundTimeout);\n      }\n      let fadeTimeOut = null;\n      this.sound = new Howl({\n        src: [link],\n        volume: 0,\n        onplay: () => {\n          this.sound.fade(0, 0.2, 1000);\n          fadeTimeOut = setTimeout(() => {\n            if (!this.sound) return;\n            this.sound.fade(0.2, 0, 1000);\n          }, 9000);\n        },\n        onstop: () => {\n          clearTimeout(fadeTimeOut);\n          clearTimeout(this.stopSoundTimeout);\n        }\n      });\n      this.sound.link = link;\n      this.sound.seek(50);\n      this.sound.play();\n      this.stopSoundTimeout = setTimeout(() => {\n        this.sound.stop();\n      }, 10000);\n    },\n    getPlayerNameById(id) {\n      return this.playersNear.find(player => player.id === id)?.name || \"anyone\";\n    },\n    onStartGame() {\n      if (!this.isReadyToStart) return;\n      this.$callClient(\"W:DanceMiniGame:StartGame\", {\n        soundId: this.selectedSoundId,\n        player: this.selectedPlayerId\n      });\n    }\n  },\n  beforeUnmount() {\n    if (this.sound) {\n      this.sound.stop();\n    }\n  },\n  components: {\n    nearIcon,\n    openIcon,\n    checkMark\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}