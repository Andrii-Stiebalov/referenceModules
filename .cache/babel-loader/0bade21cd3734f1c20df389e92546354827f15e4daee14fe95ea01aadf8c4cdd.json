{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapGetters } from \"vuex\";\nimport api from \"../mixins/api.js\";\nimport IconCastle1 from \"../assets/icons/castle-1.vue\";\nimport IconEyeHide1 from \"../assets/icons/eye-hide__1.vue\";\nimport IconEyeShow1 from \"../assets/icons/eye-show__1.vue\";\nexport default {\n  components: {\n    IconCastle1,\n    IconEyeHide1,\n    IconEyeShow1\n  },\n  mixins: [api],\n  data() {\n    return {\n      inputs: {\n        password: {\n          value: \"\",\n          focus: false,\n          show: false,\n          valid: false,\n          criterion: {\n            long: {\n              min: 8,\n              status: {\n                valid: false,\n                code: 2\n              }\n            },\n            regExp: {\n              entry: {\n                test: /^[\\da-zA-Z@#$%^&*]+$/\n              },\n              letter: {\n                test: /[a-zA-Z^\\s]/,\n                status: {\n                  valid: false,\n                  code: 2\n                }\n              },\n              number: {\n                test: /[\\d@#$%^&*]/,\n                status: {\n                  valid: false,\n                  code: 2\n                }\n              }\n            }\n          },\n          handler: {\n            focus: () => {\n              this.inputs.password.focus = true;\n            },\n            blur: () => {\n              this.inputs.password.focus = false;\n            },\n            eye: () => {\n              this.inputs.password.show = !this.inputs.password.show;\n            },\n            validate: e => {\n              this.inputs.password.valid = false;\n              this.inputs.password.criterion.long.status.code = 1;\n              this.inputs.password.criterion.regExp.letter.status.code = 1;\n              this.inputs.password.criterion.regExp.number.status.code = 1;\n              this.validatePasswordTimeout && clearTimeout(this.validatePasswordTimeout);\n              this.validatePasswordTimeout = setTimeout(() => {\n                if (e.target.value.length >= this.inputs.password.criterion.long.min) {\n                  this.inputs.password.criterion.long.status.valid = true;\n                  this.inputs.password.criterion.long.status.code = 3;\n                } else {\n                  this.inputs.password.criterion.long.status.valid = false;\n                  this.inputs.password.criterion.long.status.code = 2;\n                }\n                if (this.inputs.password.criterion.regExp.letter.test.test(e.target.value)) {\n                  this.inputs.password.criterion.regExp.letter.status.valid = true;\n                  this.inputs.password.criterion.regExp.letter.status.code = 3;\n                } else {\n                  this.inputs.password.criterion.regExp.letter.status.valid = false;\n                  this.inputs.password.criterion.regExp.letter.status.code = 2;\n                }\n                if (this.inputs.password.criterion.regExp.number.test.test(e.target.value)) {\n                  this.inputs.password.criterion.regExp.number.status.valid = true;\n                  this.inputs.password.criterion.regExp.number.status.code = 3;\n                } else {\n                  this.inputs.password.criterion.regExp.number.status.valid = false;\n                  this.inputs.password.criterion.regExp.number.status.code = 2;\n                }\n                if (!this.inputs.password.criterion.regExp.entry.test.test(e.target.value)) {\n                  this.inputs.password.criterion.regExp.number.status.valid = false;\n                  this.inputs.password.criterion.regExp.number.status.code = 2;\n                }\n                if (this.inputs.password.criterion.long.status.valid && this.inputs.password.criterion.regExp.letter.status.valid && this.inputs.password.criterion.regExp.number.status.valid) {\n                  this.inputs.password.valid = true;\n                }\n              }, 1000);\n            }\n          }\n        },\n        repeatPassword: {\n          value: \"\",\n          focus: false,\n          show: false,\n          valid: false,\n          handler: {\n            focus: () => {\n              this.inputs.repeatPassword.focus = true;\n            },\n            blur: () => {\n              this.inputs.repeatPassword.focus = false;\n            },\n            eye: () => {\n              this.inputs.repeatPassword.show = !this.inputs.repeatPassword.show;\n            }\n          }\n        }\n      }\n    };\n  },\n  computed: {\n    ...mapGetters(\"authentication\", [\"getProfile\", \"getRecovery\"])\n  },\n  methods: {\n    recoveryPassword(e) {\n      e.preventDefault();\n      if (this.inputs.password.valid) {\n        if (this.inputs.password.value === this.inputs.repeatPassword.value) {\n          this.$refs.buttonRecoveryConfirm.disabled = true;\n          this.APIuserRecoveryConfirm(this.getRecovery.email, this.getRecovery.code, this.inputs.password.value).then(data => {\n            if (data.status) {\n              this.getRecovery.status = false;\n              this.getRecovery.email = \"\";\n              this.getRecovery.code = \"\";\n              this.$router.push(\"/authentication/login\");\n              this.$Notification.create({\n                type: \"success\",\n                layout: \"compact-bottom__right\",\n                theme: \"compact\",\n                time: 5000,\n                text: `\n                                    <div class=\"notification-text__item\">\n                                        <div class=\"notification-text__item-title\">\n                                            <span>${this.$t(\"Успех\")}</span>\n                                        </div>\n                                        <div class=\"notification-text__item-subtitle\">\n                                            <span>${this.$t(\"Пароль изменен.\")}</span>\n                                        </div>\n                                    </div>\n                                    <div class=\"notification-text__item\">\n                                        <div class=\"notification-text__item-icon\">\n                                            <span class=\"icon-success\"></span>\n                                        </div>\n                                    </div>\n                                    `,\n                progressBar: false\n              });\n            } else {\n              this.$refs.buttonRecoveryConfirm.disabled = false;\n              switch (data.code) {\n                case \"0.1\":\n                  this.$Notification.create({\n                    type: \"error\",\n                    layout: \"compact-bottom__right\",\n                    theme: \"compact\",\n                    time: 5000,\n                    text: `\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-title\">\n                                                    <span>${this.$t(\"Ошибка\")}</span>\n                                                </div>\n                                                <div class=\"notification-text__item-subtitle\">\n                                                    <span>${this.$t(\"Вы ввели некорректный пароль.\")}</span>\n                                                </div>\n                                            </div>\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-icon\">\n                                                <span class=\"icon-error\"></span>\n                                                </div>\n                                            </div>\n                                            `,\n                    progressBar: false\n                  });\n                  break;\n                case \"2.0\":\n                  this.$Notification.create({\n                    type: \"error\",\n                    layout: \"compact-bottom__right\",\n                    theme: \"compact\",\n                    time: 5000,\n                    text: `\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-title\">\n                                                    <span>${this.$t(\"Ошибка\")}</span>\n                                                </div>\n                                                <div class=\"notification-text__item-subtitle\">\n                                                    <span>${this.$t(\"Пользователя с таким Email адресом не существует.\")}</span>\n                                                </div>\n                                            </div>\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-icon\">\n                                                <span class=\"icon-error\"></span>\n                                                </div>\n                                            </div>\n                                            `,\n                    progressBar: false\n                  });\n                  break;\n                case \"2.1\":\n                  this.$Notification.create({\n                    type: \"error\",\n                    layout: \"compact-bottom__right\",\n                    theme: \"compact\",\n                    time: 5000,\n                    text: `\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-title\">\n                                                    <span>${this.$t(\"Ошибка\")}</span>\n                                                </div>\n                                                <div class=\"notification-text__item-subtitle\">\n                                                    <span>${this.$t(\"Вы не указали Email адрес.\")}</span>\n                                                </div>\n                                            </div>\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-icon\">\n                                                    <span class=\"icon-error\"></span>\n                                                </div>\n                                            </div>\n                                            `,\n                    progressBar: false\n                  });\n                  break;\n                case \"2.2\":\n                  this.$Notification.create({\n                    type: \"error\",\n                    layout: \"compact-bottom__right\",\n                    theme: \"compact\",\n                    time: 5000,\n                    text: `\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-title\">\n                                                    <span>${this.$t(\"Ошибка\")}</span>\n                                                </div>\n                                                <div class=\"notification-text__item-subtitle\">\n                                                    <span>${this.$t(\"Вы не указали секретный код.\")}</span>\n                                                </div>\n                                            </div>\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-icon\">\n                                                    <span class=\"icon-error\"></span>\n                                                </div>\n                                            </div>\n                                            `,\n                    progressBar: false\n                  });\n                  break;\n                case \"2.3\":\n                  this.$Notification.create({\n                    type: \"error\",\n                    layout: \"compact-bottom__right\",\n                    theme: \"compact\",\n                    time: 5000,\n                    text: `\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-title\">\n                                                    <span>${this.$t(\"Ошибка\")}</span>\n                                                </div>\n                                                <div class=\"notification-text__item-subtitle\">\n                                                    <span>${this.$t(\"Вы указали неверный секретный код.\")}</span>\n                                                </div>\n                                            </div>\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-icon\">\n                                                    <span class=\"icon-error\"></span>\n                                                </div>\n                                            </div>\n                                            `,\n                    progressBar: false\n                  });\n                  this.recoveryCodeReset();\n                  break;\n                case \"2.4\":\n                  this.$Notification.create({\n                    type: \"error\",\n                    layout: \"compact-bottom__right\",\n                    theme: \"compact\",\n                    time: 5000,\n                    text: `\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-title\">\n                                                    <span>${this.$t(\"Ошибка\")}</span>\n                                                </div>\n                                                <div class=\"notification-text__item-subtitle\">\n                                                    <span>${this.$t(\"Вы перевысили лимит попыток ввода секретного кода, попробуйте еще раз.\")}</span>\n                                                </div>\n                                            </div>\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-icon\">\n                                                    <span class=\"icon-error\"></span>\n                                                </div>\n                                            </div>\n                                            `,\n                    progressBar: false\n                  });\n                  this.getRecovery.status = false;\n                  this.getRecovery.code = \"\";\n                  this.$router.push(\"/authentication/recovery\");\n                  break;\n                default:\n                  this.$Notification.create({\n                    type: \"error\",\n                    layout: \"compact-bottom__right\",\n                    theme: \"compact\",\n                    time: 5000,\n                    text: `\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-title\">\n                                                    <span>${this.$t(\"Ошибка\")}</span>\n                                                </div>\n                                                <div class=\"notification-text__item-subtitle\">\n                                                    <span>${this.$t(\"Что-то пошло не так. Обратитесь к администрации.\")}</span>\n                                                </div>\n                                            </div>\n                                            <div class=\"notification-text__item\">\n                                                <div class=\"notification-text__item-icon\">\n                                                    <span class=\"icon-error\"></span>\n                                                </div>\n                                            </div>\n                                            `,\n                    progressBar: false\n                  });\n                  break;\n              }\n            }\n          }).catch(() => {\n            this.$refs.buttonRecoveryConfirm.disabled = false;\n            this.$Notification.create({\n              type: \"error\",\n              layout: \"compact-bottom__right\",\n              theme: \"compact\",\n              time: 5000,\n              text: `\n                                <div class=\"notification-text__item\">\n                                    <div class=\"notification-text__item-title\">\n                                        <span>${this.$t(\"Ошибка\")}</span>\n                                    </div>\n                                    <div class=\"notification-text__item-subtitle\">\n                                        <span>${this.$t(\"Время ожидание от сервера вышло, попробуйте позже.\")}</span>\n                                    </div>\n                                </div>\n                                <div class=\"notification-text__item\">\n                                    <div class=\"notification-text__item-icon\">\n                                        <span class=\"icon-error\"></span>\n                                    </div>\n                                </div>\n                                `,\n              progressBar: false\n            });\n          });\n        } else {\n          this.$Notification.create({\n            type: \"error\",\n            layout: \"compact-bottom__right\",\n            theme: \"compact\",\n            time: 5000,\n            text: `\n                        <div class=\"notification-text__item\">\n                            <div class=\"notification-text__item-title\">\n                                <span>${this.$t(\"Ошибка\")}</span>\n                            </div>\n                            <div class=\"notification-text__item-subtitle\">\n                                <span>${this.$t(\"Пароли не совпадают.\")}</span>\n                            </div>\n                        </div>\n                        <div class=\"notification-text__item\">\n                            <div class=\"notification-text__item-icon\">\n                                <span class=\"icon-error\"></span>\n                            </div>\n                        </div>\n                    `,\n            progressBar: false\n          });\n        }\n      }\n    },\n    returnBack(route) {\n      this.$router.push(route);\n    }\n  },\n  beforeMount() {\n    if (this.getProfile.isLoggIn) {\n      return this.$router.push(\"/authentication/character\");\n    }\n    if (!this.getRecovery.status) {\n      return this.$router.push(\"/authentication/recovery/confirm\");\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}