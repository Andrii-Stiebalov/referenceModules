{"ast":null,"code":"import \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport \"./Lockpick.scss\";\nimport Spring from \"./Components/Spring.vue\";\nimport Help from \"./Components/Help.vue\";\nimport Latchkey from \"./Assets/Latchkey.vue\";\nexport default {\n  components: {\n    Spring,\n    Help,\n    Latchkey\n  },\n  data() {\n    return {\n      help: [{\n        keys: [\"W\", \"A\", \"D\"],\n        title: \"Переместить отмычку\"\n      }, {\n        keys: [\"-\"],\n        title: \"Зафиксировать\"\n      }],\n      latchkeyModifier: 4.563,\n      latchkeyPosition: 1,\n      onSwap: false,\n      animatedSprings: new Set(),\n      winCount: 0\n    };\n  },\n  computed: {\n    latchkeyStyle() {\n      return `left:${this.latchkeyModifier * (this.latchkeyPosition - 3)}vw;`;\n    }\n  },\n  methods: {\n    onKeyDown(e) {\n      if (e.keyCode === 87) this.animLatchkey();\n      if (e.keyCode === 65) this.setPosition(this.latchkeyPosition - 1);\n      if (e.keyCode === 68) this.setPosition(this.latchkeyPosition + 1);\n      if (e.keyCode === 32) this.$EBus.emit(\"keySpace\", this.latchkeyPosition);\n    },\n    animLatchkey() {\n      if (!this.onSwap && !this.animatedSprings.has(this.latchkeyPosition)) {\n        this.$EBus.emit(\"keyW\");\n        Object.assign(this.latchkey.style, {\n          animation: \"0.4s lockup\"\n        });\n        this.onUp = true;\n        setTimeout(() => {\n          Object.assign(this.latchkey.style, {\n            animation: \"\"\n          });\n          this.onUp = false;\n        }, 380);\n      }\n    },\n    setPosition(index) {\n      if (!this.onSwap) {\n        if (1 <= index && index <= 5) {\n          this.onSwap = true;\n          this.latchkeyPosition = index;\n          this.timeout = setTimeout(() => {\n            this.onSwap = false;\n          }, 500);\n        }\n      }\n    },\n    onWin() {\n      this.winCount++;\n      if (this.winCount === 5) this.$callClient(\"Lockpick:Win\");\n    },\n    springActive(i) {\n      return this.latchkeyPosition === i;\n    },\n    onAnim(id, enabled) {\n      setTimeout(() => {\n        if (enabled) this.animatedSprings.add(id);else this.animatedSprings.delete(id);\n      }, 50);\n    }\n  },\n  mounted() {\n    window.addEventListener(\"keydown\", this.onKeyDown);\n    this.latchkey = document.querySelector(\".lockpick-latchkey\");\n  },\n  beforeUnmount() {\n    window.removeEventListener(\"keydown\", this.onKeyDown);\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}